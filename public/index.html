<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Spotify Stats</title>
    <script src="./htmx.min.js"></script>
    <script>
      // When the page loads, check localStorage and restore content if it exists
      document.addEventListener("DOMContentLoaded", function () {
        const savedContent = localStorage.getItem("topSongsContent");
        if (savedContent) {
          document.getElementById("top-songs").innerHTML = savedContent;
        }
      });

      htmx.on("#top-songs", "htmx:afterSwap", function (evt) {
        localStorage.setItem("topSongsContent", evt.detail.target.innerHTML);
      });
    </script>
  </head>
  <body>
    <h1>Weekly Spotify Wraped & Stats</h1>
    <button hx-get="top_songs" hx-target="#top-songs" hx-swap="innerHTML">
      Click me to load greeting
    </button>
    <button hx-get="login" hx-target="#login" hx-swap="innerHTML">
      Click me to login
    </button>

    <!-- Target div for loaded content -->
    <div id="top-songs" hx-history-elt></div>
    <div id="login"></div>

    <!-- Add clear button to reset storage -->
    <button
      onclick="localStorage.removeItem('topSongsContent'); document.getElementById('top-songs').innerHTML = ''"
    >
      Clear Saved Content
    </button>
  </body>
</html>

